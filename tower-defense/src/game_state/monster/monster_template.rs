use super::MonsterSkillTemplate;
use super::PrebuiltSkill;
use crate::game_state::monster::MonsterKind;
use crate::game_state::route::Velocity;
use crate::*;
use namui::{Duration, State};

#[derive(State)]
pub struct MonsterTemplate {
    pub kind: MonsterKind,
    pub max_hp: f32,
    pub skills: Vec<MonsterSkillTemplate>,
    pub velocity: Velocity,
    pub damage: f32,
    pub reward: usize,
}

impl MonsterTemplate {
    fn velocity(mul: f32) -> Velocity {
        Velocity::new(5.0 * mul, Duration::from_secs(1))
    }
    fn damage(mul: f32) -> f32 {
        mul
    }
    fn reward(mul: usize) -> usize {
        mul
    }
    pub fn new(kind: MonsterKind) -> Self {
        let (velocity, damage, reward, skills) = match kind {
            MonsterKind::Mob01 => (1.0, 1.0, 3, vec![]),
            MonsterKind::Mob02 => (1.0, 1.0, 3, vec![]),
            MonsterKind::Mob03 => (1.0, 1.0, 3, vec![]),
            MonsterKind::Mob04 => (1.0, 1.0, 3, vec![]),
            MonsterKind::Mob05 => (1.0, 1.0, 3, vec![]),
            MonsterKind::Mob06 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob07 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob08 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob09 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob10 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob11 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob12 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob13 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob14 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob15 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob16 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob17 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob18 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob19 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob20 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob21 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob22 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob23 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob24 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob25 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob26 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob27 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob28 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob29 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob30 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob31 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob32 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob33 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob34 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob35 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob36 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob37 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob38 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob39 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob40 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob41 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob42 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob43 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob44 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob45 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob46 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob47 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob48 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob49 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Mob50 => (1.0, 1.0, 5, vec![]),
            MonsterKind::Named01 => (0.5, 3.0, 30, vec![PrebuiltSkill::ImmuneSlow02]),
            MonsterKind::Named02 => (0.75, 3.0, 30, vec![PrebuiltSkill::Invincible03]),
            MonsterKind::Named03 => (1.0, 3.0, 30, vec![PrebuiltSkill::Speedmul03]),
            MonsterKind::Named04 => (1.25, 3.0, 30, vec![PrebuiltSkill::ImmuneSlow03]),
            MonsterKind::Named05 => (0.5, 5.0, 30, vec![PrebuiltSkill::Heal01]),
            MonsterKind::Named06 => (0.75, 5.0, 30, vec![PrebuiltSkill::ImmuneSlow04]),
            MonsterKind::Named07 => (1.0, 5.0, 30, vec![PrebuiltSkill::Heal02]),
            MonsterKind::Named08 => (1.25, 5.0, 30, vec![PrebuiltSkill::Speedmul04]),
            MonsterKind::Named09 => (0.5, 7.0, 30, vec![PrebuiltSkill::Invincible04]),
            MonsterKind::Named10 => (0.75, 7.0, 30, vec![PrebuiltSkill::Heal03]),
            MonsterKind::Named11 => (1.0, 7.0, 30, vec![PrebuiltSkill::Heal04]),
            MonsterKind::Named12 => (1.25, 7.0, 30, vec![PrebuiltSkill::Speedmul01]),
            MonsterKind::Named13 => (0.5, 10.0, 30, vec![PrebuiltSkill::ImmuneSlow01]),
            MonsterKind::Named14 => (0.75, 10.0, 30, vec![PrebuiltSkill::Invincible01]),
            MonsterKind::Named15 => (1.0, 10.0, 30, vec![PrebuiltSkill::Invincible02]),
            MonsterKind::Named16 => (1.25, 10.0, 30, vec![PrebuiltSkill::ImmuneSlow02]),
            MonsterKind::Boss01 => (1.0, 15.0, 50, vec![PrebuiltSkill::Invincible03]),
            MonsterKind::Boss02 => (1.0, 20.0, 75, vec![PrebuiltSkill::Heal01]),
            MonsterKind::Boss03 => (1.0, 20.0, 100, vec![PrebuiltSkill::Speedmul02]),
            MonsterKind::Boss04 => (1.0, 25.0, 100, vec![PrebuiltSkill::Speedmul03]),
            MonsterKind::Boss05 => (1.0, 25.0, 125, vec![PrebuiltSkill::ImmuneSlow03]),
            MonsterKind::Boss06 => (1.0, 25.0, 125, vec![PrebuiltSkill::Heal02]),
            MonsterKind::Boss07 => (1.0, 50.0, 125, vec![PrebuiltSkill::ImmuneSlow04]),
            MonsterKind::Boss08 => (1.0, 50.0, 125, vec![PrebuiltSkill::Heal03]),
            MonsterKind::Boss09 => (1.0, 50.0, 125, vec![PrebuiltSkill::Speedmul04]),
            MonsterKind::Boss10 => (1.0, 50.0, 125, vec![PrebuiltSkill::Invincible04]),
            MonsterKind::Boss11 => (1.0, 50.0, 125, vec![PrebuiltSkill::Heal04]),
        };
        Self {
            kind,
            max_hp: Self::get_base_max_hp(kind),
            skills: skills.into_iter().map(|prebuilt| prebuilt.into()).collect(),
            velocity: Self::velocity(velocity),
            damage: Self::damage(damage),
            reward: Self::reward(reward),
        }
    }

    pub fn get_base_max_hp(kind: MonsterKind) -> f32 {
        match kind {
            MonsterKind::Mob01 => 15.0,
            MonsterKind::Mob02 => 21.0,
            MonsterKind::Mob03 => 32.0,
            MonsterKind::Mob04 => 60.0,
            MonsterKind::Mob05 => 82.0,
            MonsterKind::Mob06 => 101.0,
            MonsterKind::Mob07 => 121.0,
            MonsterKind::Mob08 => 143.0,
            MonsterKind::Mob09 => 216.0,
            MonsterKind::Mob10 => 297.0,
            MonsterKind::Mob11 => 356.0,
            MonsterKind::Mob12 => 421.0,
            MonsterKind::Mob13 => 454.0,
            MonsterKind::Mob14 => 513.0,
            MonsterKind::Mob15 => 640.0,
            MonsterKind::Mob16 => 762.0,
            MonsterKind::Mob17 => 793.0,
            MonsterKind::Mob18 => 860.0,
            MonsterKind::Mob19 => 952.0,
            MonsterKind::Mob20 => 1084.0,
            MonsterKind::Mob21 => 1773.0,
            MonsterKind::Mob22 => 2393.0,
            MonsterKind::Mob23 => 2469.0,
            MonsterKind::Mob24 => 2550.0,
            MonsterKind::Mob25 => 2680.0,
            MonsterKind::Mob26 => 2889.0,
            MonsterKind::Mob27 => 3246.0,
            MonsterKind::Mob28 => 3271.0,
            MonsterKind::Mob29 => 3564.0,
            MonsterKind::Mob30 => 4194.0,
            MonsterKind::Mob31 => 4622.0,
            MonsterKind::Mob32 => 6305.0,
            MonsterKind::Mob33 => 6636.0,
            MonsterKind::Mob34 => 7099.0,
            MonsterKind::Mob35 => 7619.0,
            MonsterKind::Mob36 => 8095.0,
            MonsterKind::Mob37 => 9067.0,
            MonsterKind::Mob38 => 10743.0,
            MonsterKind::Mob39 => 12533.0,
            MonsterKind::Mob40 => 13211.0,
            MonsterKind::Mob41 => 14106.0,
            MonsterKind::Mob42 => 15242.0,
            MonsterKind::Mob43 => 16245.0,
            MonsterKind::Mob44 => 17590.0,
            MonsterKind::Mob45 => 19461.0,
            MonsterKind::Mob46 => 21610.0,
            MonsterKind::Mob47 => 21890.0,
            MonsterKind::Mob48 => 22963.0,
            MonsterKind::Mob49 => 23462.0,
            MonsterKind::Mob50 => 24207.0,
            MonsterKind::Named01 => 100.0,
            MonsterKind::Named02 => 500.0,
            MonsterKind::Named03 => 1500.0,
            MonsterKind::Named04 => 3500.0,
            MonsterKind::Named05 => 15000.0,
            MonsterKind::Named06 => 30000.0,
            MonsterKind::Named07 => 45000.0,
            MonsterKind::Named08 => 65000.0,
            MonsterKind::Named09 => 200000.0,
            MonsterKind::Named10 => 250000.0,
            MonsterKind::Named11 => 300000.0,
            MonsterKind::Named12 => 300000.0,
            MonsterKind::Named13 => 650000.0,
            MonsterKind::Named14 => 550000.0,
            MonsterKind::Named15 => 550000.0,
            MonsterKind::Named16 => 750000.0,
            MonsterKind::Boss01 => 3500.0,
            MonsterKind::Boss02 => 10000.0,
            MonsterKind::Boss03 => 35000.0,
            MonsterKind::Boss04 => 85000.0,
            MonsterKind::Boss05 => 200000.0,
            MonsterKind::Boss06 => 300000.0,
            MonsterKind::Boss07 => 375000.0,
            MonsterKind::Boss08 => 500000.0,
            MonsterKind::Boss09 => 700000.0,
            MonsterKind::Boss10 => 850000.0,
            MonsterKind::Boss11 => 1125000.0,
        }
    }
}
