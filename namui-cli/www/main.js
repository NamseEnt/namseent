(function () {
    'use strict';

    function runAsyncMessageLoop(target, handleRequest) {
        target.onmessage = async ({ data }) => {
            switch (data.type) {
                case "request":
                    {
                        const response = await handleRequest(data.inner);
                        target.postMessage({
                            id: data.id,
                            type: "response",
                            inner: response,
                        });
                    }
                    break;
                case "response":
                    {
                        const { id, inner } = data;
                        const resolve = waitingResponseMap.get(id);
                        if (!resolve) {
                            throw new Error("no resolve for id " + id);
                        }
                        resolve(inner);
                    }
                    break;
            }
        };
    }
    const waitingResponseMap = new Map();
    let nextRequestId = 0;
    function sendAsyncRequest(target, request, transfer) {
        const id = nextRequestId++;
        return new Promise((resolve) => {
            waitingResponseMap.set(id, resolve);
            target.postMessage({
                id,
                type: "request",
                inner: request,
            }, transfer ?? []);
        });
    }

    function promisifyRequest(request) {
        return new Promise((resolve, reject) => {
            // @ts-ignore - file size hacks
            request.oncomplete = request.onsuccess = () => resolve(request.result);
            // @ts-ignore - file size hacks
            request.onabort = request.onerror = () => reject(request.error);
        });
    }
    function createStore(dbName, storeName) {
        const request = indexedDB.open(dbName);
        request.onupgradeneeded = () => request.result.createObjectStore(storeName);
        const dbp = promisifyRequest(request);
        return (txMode, callback) => dbp.then((db) => callback(db.transaction(storeName, txMode).objectStore(storeName)));
    }
    let defaultGetStoreFunc;
    function defaultGetStore() {
        if (!defaultGetStoreFunc) {
            defaultGetStoreFunc = createStore('keyval-store', 'keyval');
        }
        return defaultGetStoreFunc;
    }
    /**
     * Get a value by its key.
     *
     * @param key
     * @param customStore Method to get a custom store. Use with caution (see the docs).
     */
    function get(key, customStore = defaultGetStore()) {
        return customStore('readonly', (store) => promisifyRequest(store.get(key)));
    }
    /**
     * Set a value with a key.
     *
     * @param key
     * @param value
     * @param customStore Method to get a custom store. Use with caution (see the docs).
     */
    function set(key, value, customStore = defaultGetStore()) {
        return customStore('readwrite', (store) => {
            store.put(value, key);
            return promisifyRequest(store.transaction);
        });
    }

    function cachePrefix(key) {
        return `cache-${key}`;
    }
    function cacheGet(key) {
        return get(cachePrefix(key));
    }
    function cacheSet(key, value) {
        return set(cachePrefix(key), value);
    }

    // sab i32 [0] = notification flag. 0: request, 1: response
    // sab i32 [1] = message length
    // sab u8 [8~] = message body
    async function runMessageLoop(sab, handleMessage) {
        const i32Buf = new Int32Array(sab);
        while (true) {
            // TODO: Check if the message already sent by the worker. maybe timeout and retry?
            const wait = Atomics.waitAsync(i32Buf, 0, 0);
            if (wait.async) {
                await wait.value;
            }
            const message = readMessage(sab);
            const response = handleMessage(message);
            writeMessage(response, i32Buf);
            Atomics.notify(i32Buf, 0);
        }
    }
    function readMessage(sab) {
        const messageLength = new Int32Array(sab)[1];
        const messageBuf = new Uint8Array(sab, 8, messageLength);
        // NOTE: this is for error "The provided ArrayBufferView value must not be shared."
        const cloned = new ArrayBuffer(messageBuf.byteLength);
        new Uint8Array(cloned).set(new Uint8Array(messageBuf));
        const textDecoder = new TextDecoder();
        const message = textDecoder.decode(cloned);
        return JSON.parse(message);
    }
    function writeMessage(message, i32Buf) {
        const textEncoder = new TextEncoder();
        const messageBuf = textEncoder.encode(JSON.stringify(message));
        const messageLength = messageBuf.length;
        console.log("messageLength", messageLength);
        i32Buf[1] = messageLength;
        const buffer = new Uint8Array(i32Buf.buffer, 8, messageLength);
        buffer.set(messageBuf);
    }

    const workerToMainBufferSab = new SharedArrayBuffer(16 * 1024 * 1024);
    const mainToWorkerBufferSab = new SharedArrayBuffer(16 * 1024 * 1024);
    runMessageLoop(workerToMainBufferSab, (message) => {
        switch (message.type) {
            case "getBaseUrl": {
                return {
                    baseUrl: window.document.URL,
                };
            }
        }
    });
    const canvas = document.createElement("canvas");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    canvas.style.width = "100%";
    canvas.style.height = "100%";
    canvas.id = "canvas";
    document.body.appendChild(canvas);
    window.addEventListener("resize", () => {
        myWorker.postMessage({
            type: "windowResize",
            width: window.innerWidth,
            height: window.innerHeight,
        });
    });
    const offscreenCanvas = canvas.transferControlToOffscreen();
    const myWorker = new Worker("worker.js", {
        type: "classic",
    });
    runAsyncMessageLoop(myWorker, async (message) => {
        switch (message.type) {
            case "cacheGet": {
                const { key } = message;
                const value = await cacheGet(key);
                return {
                    value,
                };
            }
            case "cacheSet": {
                const { key, value } = message;
                await cacheSet(key, value);
                return;
            }
        }
    });
    sendAsyncRequest(myWorker, {
        type: "init",
        workerToMainBufferSab,
        mainToWorkerBufferSab,
        offscreenCanvas,
    }, [offscreenCanvas]);
    myWorker.postMessage;
    myWorker.onerror = (e) => {
        console.error(e, "error on worker");
    };
    myWorker.onmessageerror = (e) => {
        console.log("message error from worker", e);
    };
    document.oncontextmenu = (event) => {
        event.preventDefault();
    };

})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsiLi4vd2ViQ29kZS9zcmMvYXN5bmNNZXNzYWdlLnRzIiwiLi4vd2ViQ29kZS9ub2RlX21vZHVsZXMvaWRiLWtleXZhbC9kaXN0L2luZGV4LmpzIiwiLi4vd2ViQ29kZS9zcmMvY2FjaGUudHMiLCIuLi93ZWJDb2RlL3NyYy9tZXNzYWdlTG9vcC50cyIsIi4uL3dlYkNvZGUvc3JjL21haW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsidHlwZSBNZXRhTWVzc2FnZSA9IHtcbiAgICBpZDogbnVtYmVyO1xuICAgIHR5cGU6IFwicmVxdWVzdFwiIHwgXCJyZXNwb25zZVwiO1xuICAgIGlubmVyOiBhbnk7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gcnVuQXN5bmNNZXNzYWdlTG9vcChcbiAgICB0YXJnZXQ6IHtcbiAgICAgICAgb25tZXNzYWdlOiAoKHJlcXVlc3Q6IGFueSkgPT4gYW55KSB8IG51bGw7XG4gICAgICAgIHBvc3RNZXNzYWdlOiAocmVzcG9uc2U6IGFueSkgPT4gdm9pZDtcbiAgICB9LFxuICAgIGhhbmRsZVJlcXVlc3Q6IChyZXF1ZXN0OiBhbnkpID0+IFByb21pc2U8YW55Pixcbikge1xuICAgIHRhcmdldC5vbm1lc3NhZ2UgPSBhc3luYyAoeyBkYXRhIH06IHsgZGF0YTogTWV0YU1lc3NhZ2UgfSkgPT4ge1xuICAgICAgICBzd2l0Y2ggKGRhdGEudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBcInJlcXVlc3RcIjpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgaGFuZGxlUmVxdWVzdChkYXRhLmlubmVyKTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBkYXRhLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJyZXNwb25zZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXI6IHJlc3BvbnNlLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicmVzcG9uc2VcIjpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgaWQsIGlubmVyIH0gPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNvbHZlID0gd2FpdGluZ1Jlc3BvbnNlTWFwLmdldChpZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibm8gcmVzb2x2ZSBmb3IgaWQgXCIgKyBpZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShpbm5lcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuY29uc3Qgd2FpdGluZ1Jlc3BvbnNlTWFwID0gbmV3IE1hcDxudW1iZXIsIChyZXNwb25zZTogYW55KSA9PiB2b2lkPigpO1xubGV0IG5leHRSZXF1ZXN0SWQgPSAwO1xuXG5leHBvcnQgZnVuY3Rpb24gc2VuZEFzeW5jUmVxdWVzdChcbiAgICB0YXJnZXQ6IHtcbiAgICAgICAgcG9zdE1lc3NhZ2U6IChyZXNwb25zZTogYW55LCB0cmFuc2ZlcjogVHJhbnNmZXJhYmxlW10pID0+IHZvaWQ7XG4gICAgfSxcbiAgICByZXF1ZXN0OiBhbnksXG4gICAgdHJhbnNmZXI/OiBUcmFuc2ZlcmFibGVbXSxcbik6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgaWQgPSBuZXh0UmVxdWVzdElkKys7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIHdhaXRpbmdSZXNwb25zZU1hcC5zZXQoaWQsIHJlc29sdmUpO1xuXG4gICAgICAgIHRhcmdldC5wb3N0TWVzc2FnZShcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICB0eXBlOiBcInJlcXVlc3RcIixcbiAgICAgICAgICAgICAgICBpbm5lcjogcmVxdWVzdCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0cmFuc2ZlciA/PyBbXSxcbiAgICAgICAgKTtcbiAgICB9KTtcbn1cbiIsImZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3QocmVxdWVzdCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmUgLSBmaWxlIHNpemUgaGFja3NcbiAgICAgICAgcmVxdWVzdC5vbmNvbXBsZXRlID0gcmVxdWVzdC5vbnN1Y2Nlc3MgPSAoKSA9PiByZXNvbHZlKHJlcXVlc3QucmVzdWx0KTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZSAtIGZpbGUgc2l6ZSBoYWNrc1xuICAgICAgICByZXF1ZXN0Lm9uYWJvcnQgPSByZXF1ZXN0Lm9uZXJyb3IgPSAoKSA9PiByZWplY3QocmVxdWVzdC5lcnJvcik7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBjcmVhdGVTdG9yZShkYk5hbWUsIHN0b3JlTmFtZSkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIub3BlbihkYk5hbWUpO1xuICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gKCkgPT4gcmVxdWVzdC5yZXN1bHQuY3JlYXRlT2JqZWN0U3RvcmUoc3RvcmVOYW1lKTtcbiAgICBjb25zdCBkYnAgPSBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpO1xuICAgIHJldHVybiAodHhNb2RlLCBjYWxsYmFjaykgPT4gZGJwLnRoZW4oKGRiKSA9PiBjYWxsYmFjayhkYi50cmFuc2FjdGlvbihzdG9yZU5hbWUsIHR4TW9kZSkub2JqZWN0U3RvcmUoc3RvcmVOYW1lKSkpO1xufVxubGV0IGRlZmF1bHRHZXRTdG9yZUZ1bmM7XG5mdW5jdGlvbiBkZWZhdWx0R2V0U3RvcmUoKSB7XG4gICAgaWYgKCFkZWZhdWx0R2V0U3RvcmVGdW5jKSB7XG4gICAgICAgIGRlZmF1bHRHZXRTdG9yZUZ1bmMgPSBjcmVhdGVTdG9yZSgna2V5dmFsLXN0b3JlJywgJ2tleXZhbCcpO1xuICAgIH1cbiAgICByZXR1cm4gZGVmYXVsdEdldFN0b3JlRnVuYztcbn1cbi8qKlxuICogR2V0IGEgdmFsdWUgYnkgaXRzIGtleS5cbiAqXG4gKiBAcGFyYW0ga2V5XG4gKiBAcGFyYW0gY3VzdG9tU3RvcmUgTWV0aG9kIHRvIGdldCBhIGN1c3RvbSBzdG9yZS4gVXNlIHdpdGggY2F1dGlvbiAoc2VlIHRoZSBkb2NzKS5cbiAqL1xuZnVuY3Rpb24gZ2V0KGtleSwgY3VzdG9tU3RvcmUgPSBkZWZhdWx0R2V0U3RvcmUoKSkge1xuICAgIHJldHVybiBjdXN0b21TdG9yZSgncmVhZG9ubHknLCAoc3RvcmUpID0+IHByb21pc2lmeVJlcXVlc3Qoc3RvcmUuZ2V0KGtleSkpKTtcbn1cbi8qKlxuICogU2V0IGEgdmFsdWUgd2l0aCBhIGtleS5cbiAqXG4gKiBAcGFyYW0ga2V5XG4gKiBAcGFyYW0gdmFsdWVcbiAqIEBwYXJhbSBjdXN0b21TdG9yZSBNZXRob2QgdG8gZ2V0IGEgY3VzdG9tIHN0b3JlLiBVc2Ugd2l0aCBjYXV0aW9uIChzZWUgdGhlIGRvY3MpLlxuICovXG5mdW5jdGlvbiBzZXQoa2V5LCB2YWx1ZSwgY3VzdG9tU3RvcmUgPSBkZWZhdWx0R2V0U3RvcmUoKSkge1xuICAgIHJldHVybiBjdXN0b21TdG9yZSgncmVhZHdyaXRlJywgKHN0b3JlKSA9PiB7XG4gICAgICAgIHN0b3JlLnB1dCh2YWx1ZSwga2V5KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3Qoc3RvcmUudHJhbnNhY3Rpb24pO1xuICAgIH0pO1xufVxuLyoqXG4gKiBTZXQgbXVsdGlwbGUgdmFsdWVzIGF0IG9uY2UuIFRoaXMgaXMgZmFzdGVyIHRoYW4gY2FsbGluZyBzZXQoKSBtdWx0aXBsZSB0aW1lcy5cbiAqIEl0J3MgYWxzbyBhdG9taWMg4oCTIGlmIG9uZSBvZiB0aGUgcGFpcnMgY2FuJ3QgYmUgYWRkZWQsIG5vbmUgd2lsbCBiZSBhZGRlZC5cbiAqXG4gKiBAcGFyYW0gZW50cmllcyBBcnJheSBvZiBlbnRyaWVzLCB3aGVyZSBlYWNoIGVudHJ5IGlzIGFuIGFycmF5IG9mIGBba2V5LCB2YWx1ZV1gLlxuICogQHBhcmFtIGN1c3RvbVN0b3JlIE1ldGhvZCB0byBnZXQgYSBjdXN0b20gc3RvcmUuIFVzZSB3aXRoIGNhdXRpb24gKHNlZSB0aGUgZG9jcykuXG4gKi9cbmZ1bmN0aW9uIHNldE1hbnkoZW50cmllcywgY3VzdG9tU3RvcmUgPSBkZWZhdWx0R2V0U3RvcmUoKSkge1xuICAgIHJldHVybiBjdXN0b21TdG9yZSgncmVhZHdyaXRlJywgKHN0b3JlKSA9PiB7XG4gICAgICAgIGVudHJpZXMuZm9yRWFjaCgoZW50cnkpID0+IHN0b3JlLnB1dChlbnRyeVsxXSwgZW50cnlbMF0pKTtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3Qoc3RvcmUudHJhbnNhY3Rpb24pO1xuICAgIH0pO1xufVxuLyoqXG4gKiBHZXQgbXVsdGlwbGUgdmFsdWVzIGJ5IHRoZWlyIGtleXNcbiAqXG4gKiBAcGFyYW0ga2V5c1xuICogQHBhcmFtIGN1c3RvbVN0b3JlIE1ldGhvZCB0byBnZXQgYSBjdXN0b20gc3RvcmUuIFVzZSB3aXRoIGNhdXRpb24gKHNlZSB0aGUgZG9jcykuXG4gKi9cbmZ1bmN0aW9uIGdldE1hbnkoa2V5cywgY3VzdG9tU3RvcmUgPSBkZWZhdWx0R2V0U3RvcmUoKSkge1xuICAgIHJldHVybiBjdXN0b21TdG9yZSgncmVhZG9ubHknLCAoc3RvcmUpID0+IFByb21pc2UuYWxsKGtleXMubWFwKChrZXkpID0+IHByb21pc2lmeVJlcXVlc3Qoc3RvcmUuZ2V0KGtleSkpKSkpO1xufVxuLyoqXG4gKiBVcGRhdGUgYSB2YWx1ZS4gVGhpcyBsZXRzIHlvdSBzZWUgdGhlIG9sZCB2YWx1ZSBhbmQgdXBkYXRlIGl0IGFzIGFuIGF0b21pYyBvcGVyYXRpb24uXG4gKlxuICogQHBhcmFtIGtleVxuICogQHBhcmFtIHVwZGF0ZXIgQSBjYWxsYmFjayB0aGF0IHRha2VzIHRoZSBvbGQgdmFsdWUgYW5kIHJldHVybnMgYSBuZXcgdmFsdWUuXG4gKiBAcGFyYW0gY3VzdG9tU3RvcmUgTWV0aG9kIHRvIGdldCBhIGN1c3RvbSBzdG9yZS4gVXNlIHdpdGggY2F1dGlvbiAoc2VlIHRoZSBkb2NzKS5cbiAqL1xuZnVuY3Rpb24gdXBkYXRlKGtleSwgdXBkYXRlciwgY3VzdG9tU3RvcmUgPSBkZWZhdWx0R2V0U3RvcmUoKSkge1xuICAgIHJldHVybiBjdXN0b21TdG9yZSgncmVhZHdyaXRlJywgKHN0b3JlKSA9PiBcbiAgICAvLyBOZWVkIHRvIGNyZWF0ZSB0aGUgcHJvbWlzZSBtYW51YWxseS5cbiAgICAvLyBJZiBJIHRyeSB0byBjaGFpbiBwcm9taXNlcywgdGhlIHRyYW5zYWN0aW9uIGNsb3NlcyBpbiBicm93c2Vyc1xuICAgIC8vIHRoYXQgdXNlIGEgcHJvbWlzZSBwb2x5ZmlsbCAoSUUxMC8xMSkuXG4gICAgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBzdG9yZS5nZXQoa2V5KS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHN0b3JlLnB1dCh1cGRhdGVyKHRoaXMucmVzdWx0KSwga2V5KTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHByb21pc2lmeVJlcXVlc3Qoc3RvcmUudHJhbnNhY3Rpb24pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KSk7XG59XG4vKipcbiAqIERlbGV0ZSBhIHBhcnRpY3VsYXIga2V5IGZyb20gdGhlIHN0b3JlLlxuICpcbiAqIEBwYXJhbSBrZXlcbiAqIEBwYXJhbSBjdXN0b21TdG9yZSBNZXRob2QgdG8gZ2V0IGEgY3VzdG9tIHN0b3JlLiBVc2Ugd2l0aCBjYXV0aW9uIChzZWUgdGhlIGRvY3MpLlxuICovXG5mdW5jdGlvbiBkZWwoa2V5LCBjdXN0b21TdG9yZSA9IGRlZmF1bHRHZXRTdG9yZSgpKSB7XG4gICAgcmV0dXJuIGN1c3RvbVN0b3JlKCdyZWFkd3JpdGUnLCAoc3RvcmUpID0+IHtcbiAgICAgICAgc3RvcmUuZGVsZXRlKGtleSk7XG4gICAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0KHN0b3JlLnRyYW5zYWN0aW9uKTtcbiAgICB9KTtcbn1cbi8qKlxuICogRGVsZXRlIG11bHRpcGxlIGtleXMgYXQgb25jZS5cbiAqXG4gKiBAcGFyYW0ga2V5cyBMaXN0IG9mIGtleXMgdG8gZGVsZXRlLlxuICogQHBhcmFtIGN1c3RvbVN0b3JlIE1ldGhvZCB0byBnZXQgYSBjdXN0b20gc3RvcmUuIFVzZSB3aXRoIGNhdXRpb24gKHNlZSB0aGUgZG9jcykuXG4gKi9cbmZ1bmN0aW9uIGRlbE1hbnkoa2V5cywgY3VzdG9tU3RvcmUgPSBkZWZhdWx0R2V0U3RvcmUoKSkge1xuICAgIHJldHVybiBjdXN0b21TdG9yZSgncmVhZHdyaXRlJywgKHN0b3JlKSA9PiB7XG4gICAgICAgIGtleXMuZm9yRWFjaCgoa2V5KSA9PiBzdG9yZS5kZWxldGUoa2V5KSk7XG4gICAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0KHN0b3JlLnRyYW5zYWN0aW9uKTtcbiAgICB9KTtcbn1cbi8qKlxuICogQ2xlYXIgYWxsIHZhbHVlcyBpbiB0aGUgc3RvcmUuXG4gKlxuICogQHBhcmFtIGN1c3RvbVN0b3JlIE1ldGhvZCB0byBnZXQgYSBjdXN0b20gc3RvcmUuIFVzZSB3aXRoIGNhdXRpb24gKHNlZSB0aGUgZG9jcykuXG4gKi9cbmZ1bmN0aW9uIGNsZWFyKGN1c3RvbVN0b3JlID0gZGVmYXVsdEdldFN0b3JlKCkpIHtcbiAgICByZXR1cm4gY3VzdG9tU3RvcmUoJ3JlYWR3cml0ZScsIChzdG9yZSkgPT4ge1xuICAgICAgICBzdG9yZS5jbGVhcigpO1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdChzdG9yZS50cmFuc2FjdGlvbik7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBlYWNoQ3Vyc29yKHN0b3JlLCBjYWxsYmFjaykge1xuICAgIHN0b3JlLm9wZW5DdXJzb3IoKS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5yZXN1bHQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNhbGxiYWNrKHRoaXMucmVzdWx0KTtcbiAgICAgICAgdGhpcy5yZXN1bHQuY29udGludWUoKTtcbiAgICB9O1xuICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0KHN0b3JlLnRyYW5zYWN0aW9uKTtcbn1cbi8qKlxuICogR2V0IGFsbCBrZXlzIGluIHRoZSBzdG9yZS5cbiAqXG4gKiBAcGFyYW0gY3VzdG9tU3RvcmUgTWV0aG9kIHRvIGdldCBhIGN1c3RvbSBzdG9yZS4gVXNlIHdpdGggY2F1dGlvbiAoc2VlIHRoZSBkb2NzKS5cbiAqL1xuZnVuY3Rpb24ga2V5cyhjdXN0b21TdG9yZSA9IGRlZmF1bHRHZXRTdG9yZSgpKSB7XG4gICAgcmV0dXJuIGN1c3RvbVN0b3JlKCdyZWFkb25seScsIChzdG9yZSkgPT4ge1xuICAgICAgICAvLyBGYXN0IHBhdGggZm9yIG1vZGVybiBicm93c2Vyc1xuICAgICAgICBpZiAoc3RvcmUuZ2V0QWxsS2V5cykge1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3Qoc3RvcmUuZ2V0QWxsS2V5cygpKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpdGVtcyA9IFtdO1xuICAgICAgICByZXR1cm4gZWFjaEN1cnNvcihzdG9yZSwgKGN1cnNvcikgPT4gaXRlbXMucHVzaChjdXJzb3Iua2V5KSkudGhlbigoKSA9PiBpdGVtcyk7XG4gICAgfSk7XG59XG4vKipcbiAqIEdldCBhbGwgdmFsdWVzIGluIHRoZSBzdG9yZS5cbiAqXG4gKiBAcGFyYW0gY3VzdG9tU3RvcmUgTWV0aG9kIHRvIGdldCBhIGN1c3RvbSBzdG9yZS4gVXNlIHdpdGggY2F1dGlvbiAoc2VlIHRoZSBkb2NzKS5cbiAqL1xuZnVuY3Rpb24gdmFsdWVzKGN1c3RvbVN0b3JlID0gZGVmYXVsdEdldFN0b3JlKCkpIHtcbiAgICByZXR1cm4gY3VzdG9tU3RvcmUoJ3JlYWRvbmx5JywgKHN0b3JlKSA9PiB7XG4gICAgICAgIC8vIEZhc3QgcGF0aCBmb3IgbW9kZXJuIGJyb3dzZXJzXG4gICAgICAgIGlmIChzdG9yZS5nZXRBbGwpIHtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0KHN0b3JlLmdldEFsbCgpKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpdGVtcyA9IFtdO1xuICAgICAgICByZXR1cm4gZWFjaEN1cnNvcihzdG9yZSwgKGN1cnNvcikgPT4gaXRlbXMucHVzaChjdXJzb3IudmFsdWUpKS50aGVuKCgpID0+IGl0ZW1zKTtcbiAgICB9KTtcbn1cbi8qKlxuICogR2V0IGFsbCBlbnRyaWVzIGluIHRoZSBzdG9yZS4gRWFjaCBlbnRyeSBpcyBhbiBhcnJheSBvZiBgW2tleSwgdmFsdWVdYC5cbiAqXG4gKiBAcGFyYW0gY3VzdG9tU3RvcmUgTWV0aG9kIHRvIGdldCBhIGN1c3RvbSBzdG9yZS4gVXNlIHdpdGggY2F1dGlvbiAoc2VlIHRoZSBkb2NzKS5cbiAqL1xuZnVuY3Rpb24gZW50cmllcyhjdXN0b21TdG9yZSA9IGRlZmF1bHRHZXRTdG9yZSgpKSB7XG4gICAgcmV0dXJuIGN1c3RvbVN0b3JlKCdyZWFkb25seScsIChzdG9yZSkgPT4ge1xuICAgICAgICAvLyBGYXN0IHBhdGggZm9yIG1vZGVybiBicm93c2Vyc1xuICAgICAgICAvLyAoYWx0aG91Z2gsIGhvcGVmdWxseSB3ZSdsbCBnZXQgYSBzaW1wbGVyIHBhdGggc29tZSBkYXkpXG4gICAgICAgIGlmIChzdG9yZS5nZXRBbGwgJiYgc3RvcmUuZ2V0QWxsS2V5cykge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFtcbiAgICAgICAgICAgICAgICBwcm9taXNpZnlSZXF1ZXN0KHN0b3JlLmdldEFsbEtleXMoKSksXG4gICAgICAgICAgICAgICAgcHJvbWlzaWZ5UmVxdWVzdChzdG9yZS5nZXRBbGwoKSksXG4gICAgICAgICAgICBdKS50aGVuKChba2V5cywgdmFsdWVzXSkgPT4ga2V5cy5tYXAoKGtleSwgaSkgPT4gW2tleSwgdmFsdWVzW2ldXSkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGl0ZW1zID0gW107XG4gICAgICAgIHJldHVybiBjdXN0b21TdG9yZSgncmVhZG9ubHknLCAoc3RvcmUpID0+IGVhY2hDdXJzb3Ioc3RvcmUsIChjdXJzb3IpID0+IGl0ZW1zLnB1c2goW2N1cnNvci5rZXksIGN1cnNvci52YWx1ZV0pKS50aGVuKCgpID0+IGl0ZW1zKSk7XG4gICAgfSk7XG59XG5cbmV4cG9ydCB7IGNsZWFyLCBjcmVhdGVTdG9yZSwgZGVsLCBkZWxNYW55LCBlbnRyaWVzLCBnZXQsIGdldE1hbnksIGtleXMsIHByb21pc2lmeVJlcXVlc3QsIHNldCwgc2V0TWFueSwgdXBkYXRlLCB2YWx1ZXMgfTtcbiIsImltcG9ydCB7IGdldCwgc2V0IH0gZnJvbSBcImlkYi1rZXl2YWxcIjtcblxuZnVuY3Rpb24gY2FjaGVQcmVmaXgoa2V5OiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYGNhY2hlLSR7a2V5fWA7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWNoZUdldChrZXk6IHN0cmluZykge1xuICAgIHJldHVybiBnZXQoY2FjaGVQcmVmaXgoa2V5KSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWNoZVNldChrZXk6IHN0cmluZywgdmFsdWU6IGFueSkge1xuICAgIHJldHVybiBzZXQoY2FjaGVQcmVmaXgoa2V5KSwgdmFsdWUpO1xufVxuIiwiLy8gc2FiIGkzMiBbMF0gPSBub3RpZmljYXRpb24gZmxhZy4gMDogcmVxdWVzdCwgMTogcmVzcG9uc2Vcbi8vIHNhYiBpMzIgWzFdID0gbWVzc2FnZSBsZW5ndGhcbi8vIHNhYiB1OCBbOH5dID0gbWVzc2FnZSBib2R5XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBydW5NZXNzYWdlTG9vcChcbiAgICBzYWI6IFNoYXJlZEFycmF5QnVmZmVyLFxuICAgIGhhbmRsZU1lc3NhZ2U6IChyZXF1ZXN0OiBhbnkpID0+IGFueSxcbikge1xuICAgIGNvbnN0IGkzMkJ1ZiA9IG5ldyBJbnQzMkFycmF5KHNhYik7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgLy8gVE9ETzogQ2hlY2sgaWYgdGhlIG1lc3NhZ2UgYWxyZWFkeSBzZW50IGJ5IHRoZSB3b3JrZXIuIG1heWJlIHRpbWVvdXQgYW5kIHJldHJ5P1xuICAgICAgICBjb25zdCB3YWl0ID0gQXRvbWljcy53YWl0QXN5bmMoaTMyQnVmLCAwLCAwKTtcbiAgICAgICAgaWYgKHdhaXQuYXN5bmMpIHtcbiAgICAgICAgICAgIGF3YWl0IHdhaXQudmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBtZXNzYWdlID0gcmVhZE1lc3NhZ2Uoc2FiKTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBoYW5kbGVNZXNzYWdlKG1lc3NhZ2UpO1xuICAgICAgICB3cml0ZU1lc3NhZ2UocmVzcG9uc2UsIGkzMkJ1Zik7XG4gICAgICAgIEF0b21pY3Mubm90aWZ5KGkzMkJ1ZiwgMCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiByZWFkTWVzc2FnZShzYWI6IFNoYXJlZEFycmF5QnVmZmVyKTogYW55IHtcbiAgICBjb25zdCBtZXNzYWdlTGVuZ3RoID0gbmV3IEludDMyQXJyYXkoc2FiKVsxXTtcbiAgICBjb25zdCBtZXNzYWdlQnVmID0gbmV3IFVpbnQ4QXJyYXkoc2FiLCA4LCBtZXNzYWdlTGVuZ3RoKTtcblxuICAgIC8vIE5PVEU6IHRoaXMgaXMgZm9yIGVycm9yIFwiVGhlIHByb3ZpZGVkIEFycmF5QnVmZmVyVmlldyB2YWx1ZSBtdXN0IG5vdCBiZSBzaGFyZWQuXCJcbiAgICBjb25zdCBjbG9uZWQgPSBuZXcgQXJyYXlCdWZmZXIobWVzc2FnZUJ1Zi5ieXRlTGVuZ3RoKTtcbiAgICBuZXcgVWludDhBcnJheShjbG9uZWQpLnNldChuZXcgVWludDhBcnJheShtZXNzYWdlQnVmKSk7XG5cbiAgICBjb25zdCB0ZXh0RGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSB0ZXh0RGVjb2Rlci5kZWNvZGUoY2xvbmVkKTtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShtZXNzYWdlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHdyaXRlTWVzc2FnZShtZXNzYWdlOiBhbnksIGkzMkJ1ZjogSW50MzJBcnJheSkge1xuICAgIGNvbnN0IHRleHRFbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gICAgY29uc3QgbWVzc2FnZUJ1ZiA9IHRleHRFbmNvZGVyLmVuY29kZShKU09OLnN0cmluZ2lmeShtZXNzYWdlKSk7XG4gICAgY29uc3QgbWVzc2FnZUxlbmd0aCA9IG1lc3NhZ2VCdWYubGVuZ3RoO1xuICAgIGNvbnNvbGUubG9nKFwibWVzc2FnZUxlbmd0aFwiLCBtZXNzYWdlTGVuZ3RoKTtcblxuICAgIGkzMkJ1ZlsxXSA9IG1lc3NhZ2VMZW5ndGg7XG4gICAgY29uc3QgYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoaTMyQnVmLmJ1ZmZlciwgOCwgbWVzc2FnZUxlbmd0aCk7XG4gICAgYnVmZmVyLnNldChtZXNzYWdlQnVmKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJsb2NraW5nUmVxdWVzdChcbiAgICByZXF1ZXN0OiBhbnksXG4gICAgcmVxdWVzdFNhYjogU2hhcmVkQXJyYXlCdWZmZXIsXG4pOiBhbnkge1xuICAgIGNvbnN0IGkzMkJ1ZiA9IG5ldyBJbnQzMkFycmF5KHJlcXVlc3RTYWIpO1xuXG4gICAgY29uc29sZS5sb2coXCJyZXF1ZXN0XCIsIHJlcXVlc3QpO1xuICAgIHdyaXRlTWVzc2FnZShyZXF1ZXN0LCBpMzJCdWYpO1xuXG4gICAgaTMyQnVmWzBdID0gMDtcbiAgICBBdG9taWNzLm5vdGlmeShpMzJCdWYsIDApO1xuICAgIEF0b21pY3Mud2FpdChpMzJCdWYsIDAsIDApO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSByZWFkTWVzc2FnZShyZXF1ZXN0U2FiKTtcbiAgICBjb25zb2xlLmxvZyhcInJlc3BvbnNlXCIsIHJlc3BvbnNlKTtcblxuICAgIHJldHVybiByZXNwb25zZTtcbn1cbiIsImltcG9ydCB7IHJ1bkFzeW5jTWVzc2FnZUxvb3AsIHNlbmRBc3luY1JlcXVlc3QgfSBmcm9tIFwiLi9hc3luY01lc3NhZ2UuanNcIjtcbmltcG9ydCB7IGNhY2hlR2V0LCBjYWNoZVNldCB9IGZyb20gXCIuL2NhY2hlLmpzXCI7XG5pbXBvcnQgeyBydW5NZXNzYWdlTG9vcCB9IGZyb20gXCIuL21lc3NhZ2VMb29wLmpzXCI7XG5cbmNvbnN0IHdvcmtlclRvTWFpbkJ1ZmZlclNhYiA9IG5ldyBTaGFyZWRBcnJheUJ1ZmZlcigxNiAqIDEwMjQgKiAxMDI0KTtcbmNvbnN0IG1haW5Ub1dvcmtlckJ1ZmZlclNhYiA9IG5ldyBTaGFyZWRBcnJheUJ1ZmZlcigxNiAqIDEwMjQgKiAxMDI0KTtcblxucnVuTWVzc2FnZUxvb3Aod29ya2VyVG9NYWluQnVmZmVyU2FiLCAobWVzc2FnZSkgPT4ge1xuICAgIHN3aXRjaCAobWVzc2FnZS50eXBlKSB7XG4gICAgICAgIGNhc2UgXCJnZXRCYXNlVXJsXCI6IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgYmFzZVVybDogd2luZG93LmRvY3VtZW50LlVSTCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcbmNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuY2FudmFzLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcbmNhbnZhcy5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xuY2FudmFzLnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xuY2FudmFzLmlkID0gXCJjYW52YXNcIjtcbmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2FudmFzKTtcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgKCkgPT4ge1xuICAgIG15V29ya2VyLnBvc3RNZXNzYWdlKHtcbiAgICAgICAgdHlwZTogXCJ3aW5kb3dSZXNpemVcIixcbiAgICAgICAgd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLFxuICAgICAgICBoZWlnaHQ6IHdpbmRvdy5pbm5lckhlaWdodCxcbiAgICB9KTtcbn0pO1xuXG5jb25zdCBvZmZzY3JlZW5DYW52YXMgPSBjYW52YXMudHJhbnNmZXJDb250cm9sVG9PZmZzY3JlZW4oKTtcblxuY29uc3QgbXlXb3JrZXIgPSBuZXcgV29ya2VyKFwid29ya2VyLmpzXCIsIHtcbiAgICB0eXBlOiBcImNsYXNzaWNcIixcbn0pO1xuXG5ydW5Bc3luY01lc3NhZ2VMb29wKG15V29ya2VyLCBhc3luYyAobWVzc2FnZSkgPT4ge1xuICAgIHN3aXRjaCAobWVzc2FnZS50eXBlKSB7XG4gICAgICAgIGNhc2UgXCJjYWNoZUdldFwiOiB7XG4gICAgICAgICAgICBjb25zdCB7IGtleSB9ID0gbWVzc2FnZTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXdhaXQgY2FjaGVHZXQoa2V5KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgXCJjYWNoZVNldFwiOiB7XG4gICAgICAgICAgICBjb25zdCB7IGtleSwgdmFsdWUgfSA9IG1lc3NhZ2U7XG4gICAgICAgICAgICBhd2FpdCBjYWNoZVNldChrZXksIHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG5zZW5kQXN5bmNSZXF1ZXN0KFxuICAgIG15V29ya2VyLFxuICAgIHtcbiAgICAgICAgdHlwZTogXCJpbml0XCIsXG4gICAgICAgIHdvcmtlclRvTWFpbkJ1ZmZlclNhYixcbiAgICAgICAgbWFpblRvV29ya2VyQnVmZmVyU2FiLFxuICAgICAgICBvZmZzY3JlZW5DYW52YXMsXG4gICAgfSxcbiAgICBbb2Zmc2NyZWVuQ2FudmFzXSxcbik7XG5teVdvcmtlci5wb3N0TWVzc2FnZTtcblxubXlXb3JrZXIub25lcnJvciA9IChlKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlLCBcImVycm9yIG9uIHdvcmtlclwiKTtcbn07XG5cbm15V29ya2VyLm9ubWVzc2FnZWVycm9yID0gKGUpID0+IHtcbiAgICBjb25zb2xlLmxvZyhcIm1lc3NhZ2UgZXJyb3IgZnJvbSB3b3JrZXJcIiwgZSk7XG59O1xuXG5kb2N1bWVudC5vbmNvbnRleHRtZW51ID0gKGV2ZW50KSA9PiB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbn07XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0lBTWdCLFNBQUEsbUJBQW1CLENBQy9CLE1BR0MsRUFDRCxhQUE2QyxFQUFBO1FBRTdDLE1BQU0sQ0FBQyxTQUFTLEdBQUcsT0FBTyxFQUFFLElBQUksRUFBeUIsS0FBSTtZQUN6RCxRQUFRLElBQUksQ0FBQyxJQUFJO0lBQ2IsWUFBQSxLQUFLLFNBQVM7SUFDVixnQkFBQTt3QkFDSSxNQUFNLFFBQVEsR0FBRyxNQUFNLGFBQWEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7d0JBQ2pELE1BQU0sQ0FBQyxXQUFXLENBQUM7NEJBQ2YsRUFBRSxFQUFFLElBQUksQ0FBQyxFQUFFO0lBQ1gsd0JBQUEsSUFBSSxFQUFFLFVBQVU7SUFDaEIsd0JBQUEsS0FBSyxFQUFFLFFBQVE7SUFDbEIscUJBQUEsQ0FBQyxDQUFDO0lBQ04saUJBQUE7b0JBQ0QsTUFBTTtJQUNW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
