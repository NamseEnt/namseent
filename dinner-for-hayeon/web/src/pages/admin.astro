---
import Layout from "../layouts/Layout.astro";
import { getSessionUser, checkAdmin } from "@/utils/auth.ts";
import AdminPage from "../components/admin/Admin.tsx";

export const prerender = false;

const sessionUser = await getSessionUser(Astro.request);

// 로그인하지 않았거나 admin이 아닌 경우 리다이렉트
if (!sessionUser) {
  return Astro.redirect("/");
}

if (!checkAdmin(sessionUser)) {
  return Astro.redirect("/");
}
---

<Layout title="관리자 페이지 - 하연이에게 저녁을">
  <AdminPage sessionUser={sessionUser} client:load />
</Layout>
